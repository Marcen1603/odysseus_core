#PARSER PQL
#RUNQUERY
data§wkaid§ = STREAM({SOURCE='System.P§windfarmid§:§wkaid§'})
timewindow§wkaid§ = TIMEWINDOW({slide=[5,'SECONDS'],size=[5,'SECONDS']},data§wkaid§)
aggregate§wkaid§ = AGGREGATE({AGGREGATIONS=[['AVG','wind_speed','AVG_wind_speed','Double'],['AVG','corrected_score','AVG_corrected_score','Double'],['AVG','wind_direction','AVG_wind_direction','Double'],['AVG','rotational_speed','AVG_rotational_speed','Double'],['AVG','phase_shift','AVG_phase_shift','Double'],['AVG','pitch_angle','AVG_pitch_angle','Double'],['AVG','gier_angle','AVG_gier_angle','Double']], GROUP_BY=['P§windfarmid§:§wkaid§.id']},timewindow§wkaid§)
map§wkaid§ = MAP({expressions=[['0','id'],['§windfarmid§','wp_id'],['P§windfarmid§:§wkaid§.id','wka_id'],['now()','timestamp'],['AVG_wind_speed',''],['AVG_corrected_score',''],['AVG_wind_direction',''],['AVG_rotational_speed',''],['AVG_phase_shift',''],['AVG_pitch_angle',''],['AVG_gier_angle',''],['''','comment']], THREADS=0},aggregate§wkaid§)
hdsink§wkaid§ = DATABASESINK({connection='CONHD',table='HDarchive',tableschema=['Integer','Integer','Integer','Timestamp','double','double','double','double','double','double','double','string'], LAZY_CONNECTION_CHECK='false'},map§wkaid§)