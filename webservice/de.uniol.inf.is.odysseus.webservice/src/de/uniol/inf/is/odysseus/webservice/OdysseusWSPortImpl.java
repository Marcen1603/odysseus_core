
/**
 * Please modify this class to meet your needs
 * This class is not complete
 */

package de.uniol.inf.is.odysseus.webservice;

import java.util.Collection;

import de.uniol.inf.is.odysseus.action.physicaloperator.EventDetectionSink;
import de.uniol.inf.is.odysseus.base.planmanagement.query.querybuiltparameter.ParameterDefaultRoot;
import de.uniol.inf.is.odysseus.planmanagement.executor.IAdvancedExecutor;
import de.uniol.inf.is.odysseus.planmanagement.executor.exception.PlanManagementException;

/**
 * This class was generated by Apache CXF 2.2.5
 * Thu Dec 03 14:29:31 CET 2009
 * Generated source version: 2.2.5
 * 
 */

@javax.jws.WebService(
                      serviceName = "OdysseusWS",
                      portName = "OdysseusWSSOAP",
                      targetNamespace = "http://de.uni.ol.inf.is.odysseus/OdysseusWS/",
                      //wsdlLocation = "file:OdysseusWebService.wsdl",
                      endpointInterface = "de.uniol.inf.is.odysseus.webservice.OdysseusWSPort")
                      
public class OdysseusWSPortImpl implements OdysseusWSPort {
	//FIXME woher executer objekt?
	private IAdvancedExecutor executor;

    /* (non-Javadoc)
     * @see de.uniol.inf.is.odysseus.webservice.OdysseusWSPort#createStatement(java.lang.String  query )*
     */
    public java.lang.String createStatement(java.lang.String query) { 
    	//check if statement is a eca-statement
    	if (query.toLowerCase().startsWith("when")){
    		try {
				Collection<Integer> queryId = executor.addQuery(query, "ECA", new ParameterDefaultRoot(new EventDetectionSink()));
				//FIXME mehrere ids fuer eine query?
				return "OK";
			} catch (PlanManagementException e) {
				return "FAIL";
			}
    	}else {
    		return null;
    	}
    }

    /* (non-Javadoc)
     * @see de.uniol.inf.is.odysseus.webservice.OdysseusWSPort#createSource(java.lang.String  sourceDescription )*
     */
    public java.lang.String createSource(java.lang.String sourceDescription) { 
    	//TODO implementieren
    	return null;
    }

    /* (non-Javadoc)
     * @see de.uniol.inf.is.odysseus.webservice.OdysseusWSPort#getSchema(java.lang.String  id )*
     */
    public java.lang.String[] getSchema(java.lang.String id) { 
        //TODO implementieren
    	return null;
    }

}
