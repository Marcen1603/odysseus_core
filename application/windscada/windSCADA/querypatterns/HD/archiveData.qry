#PARSER PQL
#RUNQUERY
data§wka_id§ = STREAM({SOURCE='System.P§windfarm_id§:§wka_id§'})
timewindow§wka_id§ = TIMEWINDOW({slide=[5,'SECONDS'],size=[5,'SECONDS']},data§wka_id§)
aggregate§wka_id§ = AGGREGATE({AGGREGATIONS=[['AVG','wind_speed','AVG_wind_speed','Double'],['AVG','corrected_score','AVG_corrected_score','Double'],['AVG','wind_direction','AVG_wind_direction','Double'],['AVG','rotational_speed','AVG_rotational_speed','Double'],['AVG','phase_shift','AVG_phase_shift','Double'],['AVG','pitch_angle','AVG_pitch_angle','Double'],['AVG','gear_angle','AVG_gear_angle','Double']], GROUP_BY=['P§windfarm_id§:§wka_id§.id']},timewindow§wka_id§)
map§wka_id§ = MAP({expressions=[['0','id'],['§windfarm_id§','wp_id'],['P§windfarm_id§:§wka_id§.id','wka_id'],['now()','timestamp'],['AVG_wind_speed',''],['AVG_corrected_score',''],['AVG_wind_direction',''],['AVG_rotational_speed',''],['AVG_phase_shift',''],['AVG_pitch_angle',''],['AVG_gear_angle',''],['''','comment']], THREADS=0},aggregate§wka_id§)
hdsink§wka_id§ = DATABASESINK({connection='CONHD',table='HDarchive',tableschema=['Integer','Integer','Integer','Timestamp','double','double','double','double','double','double','double','string'], LAZY_CONNECTION_CHECK='false'},map§wka_id§)