#PARSER PQL
#RUNQUERY

input = ACCESS({source='Source',
wrapper='GenericPush',
transport='Timer',
protocol='None',
dataHandler='Tuple',
options=[['period', '1000']],
schema=[['time', 'Timestamp']]
})

func = MAP({EXPRESSIONS = [['rnd()','x'],['rnd()','y']]}, input)

win = ELEMENTWINDOW({SIZE = 4}, func)

agg = AGGREGATE({AGGREGATIONS = [
['DTW', ['x','y'], 'dtw'],
['fft', 'x', 'fft'],
['SpectralCentroid', ['x','y'], 'spectralCentroid']
]}, win)


