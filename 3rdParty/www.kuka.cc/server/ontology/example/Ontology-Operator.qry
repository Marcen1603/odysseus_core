#PARSER PQL
#METADATA TimeInterval

#DEFINE QUALITY

#IFDEF QUALITY
#METADATA Quality
#ENDIF


#RUNQUERY
ApplicationArea:TemperatureSensor := ACCESS({source='ApplicationArea:TemperatureSensor',
wrapper='GenericPush',
transport='Timer',
protocol='None',
dataHandler='Tuple',
options=[['period', '1000']],
schema=[['timestamp', 'Timestamp']]
})

#ADDQUERY

input1 = ACCESS({source='LocationSensor',
wrapper='GenericPush',
transport='Timer',
protocol='None',
dataHandler='Tuple',
options=[['period', '1000']],
schema=[['time', 'Timestamp']]
})



in = TIMESTAMP({MILLISECOND = 'timestamp'}, MAP({EXPRESSIONS = [['toLong(time)', 'timestamp'], ['0.5', 'X']]}, input1))

out = QUALITY({ATTRIBUTES = ['X'], PROPERTIES = ['Accuracy']}, in)