#PARSER PQL
#METADATA TimeInterval

#DEFINE QUALITY

#IFDEF QUALITY
#METADATA Quality
#ENDIF

#ADDQUERY

input = ACCESS({source='Source',
wrapper='GenericPush',
transport='Timer',
protocol='None',
dataHandler='Tuple',
options=[['period', '1000']],
schema=[['time', 'Timestamp']]
})

in = TIMESTAMP({MILLISECOND = 'timestamp'}, MAP({EXPRESSIONS = [['toLong(time)', 'timestamp'], ['20','f'], ['0.5', 'com'], ['0.5', 'con']]}, input))
out = QUALITYINDICATOR({FREQUENCY = 'f', COMPLETENESS = 'com', CONSISTENCY = 'con'},in)