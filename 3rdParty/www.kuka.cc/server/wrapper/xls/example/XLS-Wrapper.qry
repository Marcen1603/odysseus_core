#PARSER PQL
#ADDQUERY

input = ACCESS({source='Source',
wrapper='GenericPush',
transport='Timer',
protocol='None',
dataHandler='Tuple',
options=[['period', '1000']],
schema=[['time', 'Timestamp']]
})

data = map({expressions = [['rnd()','x']]}, input)


out = SENDER({
TRANSPORT = 'FILE', 
DATAHANDLER = 'Tuple', 
SINK = 'Excel',
WRAPPER = 'GenericPush', 
PROTOCOL = 'XLS',
OPTIONS = [
 ['filename','${ROOT}/test.xls']
 ]
}, data)


in = ACCESS({
TRANSPORT = 'FILE', 
DATAHANDLER = 'Tuple', 
Source = 'ExcelIn',
WRAPPER = 'GenericPull', 
PROTOCOL = 'XLS',
schema = [['x', 'Double']],
OPTIONS = [
 ['filename','${ROOT}/test.xls'],
 ['readfirstline','false'],
 ['worksheet','Odysseus']
 ]
})