///OdysseusScript
#PARSER PQL
#METADATA TimeInterval
#METADATA Probabilistic
#ADDQUERY
data0 = ACCESS({
    source='source', 
    wrapper='GenericPull',
    transport='file', 
    protocol='SimpleCSV',
    dataHandler='ProbabilisticTuple', 
    options=[
        ['filename', '${BUNDLE-ROOT}\test\join\input0.csv'], 
///        ['filename', '${ROOT}/input0.csv'], 
        ['csv.delimiter', ','],
        ['csv.trim', 'true']
        ], 
    schema=[
        ['timestamp0', 'STARTTIMESTAMP'], 
        ['x0', 'Double'],
        ['y0', 'Double']
]})
data1 = ACCESS({
    source='source2', 
    wrapper='GenericPull',
    transport='file', 
    protocol='SimpleCSV',
    dataHandler='ProbabilisticTuple', 
    options=[
        ['filename', '${BUNDLE-ROOT}\test\join\input1.csv'], 
///        ['filename', '${ROOT}/input1.csv'], 
        ['csv.delimiter', ','],
        ['csv.trim', 'true']
        ], 
    schema=[
        ['timestamp1', 'STARTTIMESTAMP'], 
        ['x1', 'Double'],
        ['y1', 'Double']
]})
in0 = WINDOW({SIZE = 2, TYPE = 'tuple'}, project({attributes = ['timestamp0', 'x0', 'y0']}, Distribution({attributes = ['x0', 'y0'], variance = 'variance0', continuous = 'true'}, Map({expressions = [['timestamp0','timestamp0'], ['x0','x0'], ['y0','y0'], ['[1.0, 0.5; 0.5, 1.0]','variance0']]}, data0))))
in1 = WINDOW({SIZE = 2, TYPE = 'tuple'}, project({attributes = ['timestamp1', 'x1', 'y1']}, Distribution({attributes = ['x1', 'y1'], variance = 'variance1', continuous = 'true'}, Map({expressions = [['timestamp1','timestamp1'], ['x1','x1'], ['y1','y1'], ['[1.0, 0.5; 0.5, 1.0]','variance1']]}, data1))))
out = JOIN({PREDICATE = ProbabilisticRelationalPredicate('x0<3 && x1<2')}, in0, in1)