///OdysseusScript
#PARSER PQL
#METADATA TimeInterval
#METADATA Probabilistic
#ADDQUERY
data = ACCESS({
    source='source', 
    wrapper='GenericPull',
    transport='file', 
    protocol='SimpleCSV',
    dataHandler='ProbabilisticTuple', 
    options=[
        ['filename', '${BUNDLE-ROOT}\test\aggregate\input0.csv'], 
///        ['filename', '${ROOT}/input0.csv'], 
        ['csv.delimiter', ','],
        ['csv.trim', 'true']
        ], 
    schema=[
        ['timestamp', 'STARTTIMESTAMP'], 
        ['x', 'Double'],
        ['y', 'Double']
]})

in = WINDOW({SIZE = 4, TYPE = 'tuple'}, Distribution({attributes = ['x', 'y'], variance = 'variance', continuous = 'true'}, Map({expressions = [['timestamp','timestamp'], ['x','x'], ['y','y'], ['[1.0, 0.5; 0.5, 1.0]','variance']]}, data)))
out = AGGREGATE({AGGREGATIONS = [['count', 'x', 'countX'],['sum', 'x', 'sumX', 'ProbabilisticDouble'],['avg', 'x', 'avgX', 'ProbabilisticDouble']]}, in)