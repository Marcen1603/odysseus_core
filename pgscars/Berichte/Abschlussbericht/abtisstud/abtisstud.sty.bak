%% Stylepaket als Grundlage für Studentische Arbeiten
%% in der Abteilung Informationssysteme
%%
%% Erstellt am 02.06.2007 von Markus Schmees
%% Neue Version (abtisstud) für Studentische Arbeiten am 25.06.2007 von Marco Grawunder
%% Caption jetzt durch das Caption-Paket einheitlich 20.2.2008 Marco Grawunder
%% Schusterjungen und Hurenkinder werden vermieden 14.04.2008 Marco Grawunder
%%
%% Bitte einbinden mit \usepackage{abtisstud}

% Paket-Deklaration
\ProvidesPackage{abtisstud/abtisstud}

% Importierte Pakete
\usepackage{color}      % Wegen Farbigen Kapitelüberschriften
\usepackage{fancyhdr}   % Für die eigenen Headerdefinitionen
\usepackage{graphicx}
\usepackage{caption}

\captionsetup{font={sf,it}, justification=centering}

% Tiefe des Inhaltsverzeichnisses, Numerierung der Abschnitte
\setcounter{secnumdepth}{3}
\setcounter{tocdepth}{1}

% Oberer Rand und Header, Textstart ab 3.5cm
\setlength{\voffset}{-1.0in}
\setlength{\topmargin}{2.3cm}
\setlength{\headheight}{0.5cm}
\setlength{\headsep}{0.7cm}

% Rand immer 3.5cm
\setlength{\hoffset}{-1.0in}
\setlength{\oddsidemargin}{3.2 cm}
\setlength{\evensidemargin}{2.3 cm}

% Textfeldgröße
\setlength{\textwidth}{15.5cm}
\setlength{\textheight}{22.2cm}

% Fußzeileunterseite 1cm unter Textende
\setlength{\footskip}{1.0cm}

% Paragraphen-Layout
\setlength{\parindent}{0.37cm}  % Linker Einzug beim neuen Absatz
\newcommand{\standardparskip}[0]{\setlength{\parskip}{6pt}}
\newcommand{\miniparskip}[0]{\setlength{\parskip}{2pt}}
\standardparskip   % Abstand zwischen den Absätzen


% Einstellen der Header
\pagestyle{fancy}
\renewcommand{\chaptermark}[1]{\markboth{#1}{}}
\renewcommand{\sectionmark}[1]{\markright{\thesection\ #1}}
\fancyhf{} % delete current setting for header and footer
\fancyhead[LE,RO]{\small \sffamily \thepage}
\fancyhead[LO]{\small \sffamily \rightmark}
\fancyhead[RE]{\small \sffamily \leftmark}
\renewcommand{\headrulewidth}{0.5pt}
\renewcommand{\footrulewidth}{0pt}
\fancypagestyle{plain}{%
  \fancyhead[RO]{\small \sffamily \thepage}
  %\fancyhead[LO]{\small \sffamily \chaptername~\thechapter}
  \fancyhead[LO]{~}
} % Ende von fancypagestyle



% Überschriften und Abstände zum Text
% Das Chapter muss rein wegen Umbrüchen auf Kapitelüberschriftsebene
\renewcommand\chapter{\if@openright\cleardoublepage\else\clearpage\fi%
                      \addtocontents{lof}{\protect\addvspace{10\p@}}%
                      \addtocontents{lot}{\protect\addvspace{10\p@}}%
                                  \@startsection{chapter}{0}{\z@}%
                                   {-18pt}%
                                   {12pt}%
                                   {\sffamily\LARGE\bfseries\color[rgb]{0.6,0.6,0.6} }}
\renewcommand\section{\@startsection{section}{1}{\z@}%
                                   {-18pt}%
                                   {6pt}%
                                   {\sffamily\large\bfseries}}
\renewcommand\subsection{\@startsection{subsection}{2}{\z@}%
                                   {-18pt}%
                                   {6pt}%
                                   {\sffamily\large}}
\renewcommand\subsubsection{\@startsection{subsubsection}{3}{\z@}%
                                   {-12pt}%
                                   {3pt}%
                                   {\sffamily\large}}
\renewcommand\paragraph{\@startsection{paragraph}{4}{\z@}%
                                   {-12pt}%
                                   {1pt}%
                                   {\sffamily\normalsize}}


% Spezielle farbige Einstellungen und Abstände für \chapter*
\def\@makeschapterhead#1{%
  {\parindent \z@ \raggedright \normalfont
    \interlinepenalty\@M
    \LARGE \color[rgb]{0.6,0.6,0.6} \sffamily \bfseries  #1\par\nobreak
    \vskip 12\p@
    \chaptermark{#1}
  }}


% Indexitems weniger stark einrücken, mehr Abstand zwischen Indexbuchstaben
\renewcommand\subitem{\@idxitem \hspace*{10\p@}}
\renewcommand\subsubitem{\@idxitem \hspace*{20\p@}}
\newcommand\indexfrontskip{\vskip 4\p@}


% Verzeichnisdeklaration anpassen für Header
\renewcommand\tableofcontents{%
    \if@twocolumn
      \@restonecoltrue\onecolumn
    \else
      \@restonecolfalse
    \fi
    \chapter*{\contentsname
        \@mkboth{\contentsname}{~}}%
    \miniparskip%
    \@starttoc{toc}%
    \standardparskip%
    \if@restonecol\twocolumn\fi
    }
\renewcommand\listoffigures{%
    \if@twocolumn
      \@restonecoltrue\onecolumn
    \else
      \@restonecolfalse
    \fi
    \chapter*{\listfigurename}%
      \@mkboth{\listfigurename}{~}%
    \miniparskip%
    \@starttoc{lof}%
    \standardparskip%
    \if@restonecol\twocolumn\fi
    }
%\renewcommand\listofalgorithms{%
%    \if@twocolumn
%      \@restonecoltrue\onecolumn
%    \else
%      \@restonecolfalse
%    \fi
%    \chapter*{\listalgorithmcfname}%
%      \@mkboth{\listalgorithmcfname}{~}%
%    \miniparskip%
%    \@starttoc{lof}%
%    \standardparskip%
%    \if@restonecol\twocolumn\fi
%    }
\renewcommand\listoftables{%
    \if@twocolumn
      \@restonecoltrue\onecolumn
    \else
      \@restonecolfalse
    \fi
    \chapter*{\listtablename}%
      \@mkboth{\listtablename}{~}%
    \miniparskip%
    \@starttoc{lot}%
    \standardparskip%
    \if@restonecol\twocolumn\fi
    }

% Umgebungen für Header anpassen
\renewenvironment{thebibliography}[1]
     {\chapter*{\bibname}%
      \@mkboth{\bibname}{~}%
      \list{\@biblabel{\@arabic\c@enumiv}}%
           {\settowidth\labelwidth{\@biblabel{#1}}%
            \leftmargin\labelwidth
            \advance\leftmargin\labelsep
            \@openbib@code
            \usecounter{enumiv}%
            \let\p@enumiv\@empty
            \renewcommand\theenumiv{\@arabic\c@enumiv}}%
      \sloppy
      \clubpenalty4000
      \@clubpenalty \clubpenalty
      \widowpenalty4000%
      \sfcode`\.\@m}
     {\def\@noitemerr
       {\@latex@warning{Empty `thebibliography' environment}}%
      \endlist
      }

\renewenvironment{theindex}
               {\if@twocolumn
                  \@restonecolfalse
                \else
                  \@restonecoltrue
                \fi
                \twocolumn[\@makeschapterhead{\indexname}]%
                \@mkboth{\indexname}{~}%
                \thispagestyle{plain}\parindent\z@
                \parskip\z@ \@plus .3\p@\relax
                \columnseprule \z@
                \columnsep 35\p@
                \let\item\@idxitem}
               {\if@restonecol\onecolumn\else\clearpage\fi}


% Abbildungen und deren Unterschriften
%\setlength\abovecaptionskip{0.42cm}     % Abstand zwischen Bild und Unterschrift
%\long\def\@caption#1[#2]#3{%
%  \par
%  \addcontentsline{\csname ext@#1\endcsname}{#1}%
%    {\protect\numberline{\csname the#1\endcsname}{\ignorespaces #2}}%
%  \begingroup
%    \@parboxrestore
%    \if@minipage
%      \@setminipage
%    \fi
%    \small
%    \@makecaption{\sffamily \itshape \csname fnum@#1\endcsname}{\ignorespaces #3}\par
%  \endgroup}


% Fußnoten linksbündig und ein Space zwischen Nummer und Text
\usepackage[bottom,hang]{footmisc}
\setlength{\footnotemargin}{0pt}
\let\oldfncomm=\footnote
\renewcommand{\footnote}[1]{\oldfncomm{~#1}}


% Listen (itemize, enumerate) linksbündig
\usepackage[flushright]{paralist}
\setdefaultleftmargin{0.5cm}{}{}{}{}{}


% Nützliche Zusatzbefehle für das Glossar usw.
\newcommand{\comment}[1]{}
\newcommand{\siehe}[1]{$\uparrow$#1}
\newcommand{\this}[0]{$\sim$ }


% Zusatzkapitel ohne Nummer aber mit Eintrag im TOC
\newcommand{\addonchapter}[1]{
  \cleardoublepage%
  \chapter*{#1}%
  \addcontentsline{toc}{chapter}{#1}
  \chaptermark{#1}
}

%%Silbentrennung in Typewriter
\newcommand{\origttfamily}{}% sollte noch nicht definiert sein!
\let\origttfamily=\ttfamily % alte Definition von \ttfamily sichern
\renewcommand{\ttfamily}{\origttfamily \hyphenchar\font=`\-}

% Offizielle Titelseite
\def\erstgutachter#1{\gdef\@erstgutachter{#1}}
\def\zweitgutachter#1{\gdef\@zweitgutachter{#1}}
\def\arbeitstyp#1{\gdef\@arbeitstyp{#1}}

\renewcommand\maketitle{\begin{titlepage}%
  \begin{center}%
  %\includegraphics[width=0.5\textwidth]{abtisstud/unilogo.eps} \\
  \rotatebox{0}{\includegraphics[width=0.5\textwidth]{abtisstud/unilogo.pdf}} \\
  \begin{sffamily}
    Fakultät II -- Informatik, Wirtschafts- und Rechtswissenschaften \\[0.1em]
    Department für Informatik \\
  \end{sffamily}

  \vspace*{2cm}

  \@arbeitstyp

  \begin{sffamily}
    \huge \bfseries \@title
  \end{sffamily}

  \vspace*{1.5cm}

  \vspace*{1.5cm}

  vorgelegt von \\[0.75em]
  \large \textbf{\@author}

  \vspace*{2cm}

  \normalsize

  Gutachter: \\[0.75em]
  \begin{bfseries}
    \@erstgutachter\\[0.2em]
    \@zweitgutachter
  \end{bfseries}
  \vspace*{1.2cm}

  \@date
  \vfill
  \end{center}
\end{titlepage}
}

\newcommand\versicherung[1]{\chapter*{Versicherung}
\thispagestyle{empty}
Hiermit versichere ich, dass ich diese Arbeit selbstständig verfasst und keine anderen als die angegebenen Hilfsmittel und Quellen verwendet habe.

\vspace{1.5cm}

#1, den \today

\vspace*{-0.5cm}\hspace*{5.5cm}\hrulefill\\
\hspace*{6.5cm}\hfill \@author\hfill\mbox{}
}


\newcommand\tchapter{\@startsection{chapter}{0}{\z@}%
                                   {-18pt}%
                                   {12pt}%
                                   {\sffamily\LARGE\bfseries\color[rgb]{0.6,0.6,0.6} }}

%Schusterjungen und Hurenkinder vermeiden
\clubpenalty = 10000
\widowpenalty = 10000 \displaywidowpenalty = 10000