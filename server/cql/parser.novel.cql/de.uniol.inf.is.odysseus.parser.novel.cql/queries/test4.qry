#PARSER PQL
#RUNQUERY

pql_stream1 = ACCESS({Source='pql_stream1', Wrapper='GenericPush',
        Schema=[['timestamp ','Starttimestamp'],
                ['transaction_id','INTEGER'],
                ['name','STRING'],
                ['value','INTEGER']],
                transport='NonBlockingTcp',
                protocol='SizeByteBuffer',
                dataHandler='Tuple',
                Options=[['port','135'], ['host','localhost']]})

pql_stream2 = ACCESS({Source='pql_stream2', Wrapper='GenericPush',
        Schema=[['timestamp ','Starttimestamp'],
                ['transaction_id','INTEGER'],
                ['name','STRING'],
                ['value','INTEGER']],
                transport='NonBlockingTcp',
                protocol='SizeByteBuffer',
                dataHandler='Tuple',
                Options=[['port','135'], ['host','localhost']]})

pql_stream3 = ACCESS({Source='pql_stream3', Wrapper='GenericPush',
        Schema=[['timestamp ','Starttimestamp'],
                ['transaction_id','INTEGER'],
                ['name','STRING'],
                ['value','INTEGER']],
                transport='NonBlockingTcp',
                protocol='SizeByteBuffer',
                dataHandler='Tuple',
                Options=[['port','135'], ['host','localhost']]})

output = join(pql_stream1, join(pql_stream2, pql_stream3))              
                            
select_1 = SELECT({predicate='true'}, pql_stream1)

project_1 = PROJECT({ATTRIBUTES=['name','value','transaction_id']}, pql_stream3)


    