#PARSER PQL
#RUNQUERY

input = ACCESS({
    source='input', wrapper='GenericPush',
    transport='UDPServer', protocol='SizeByteBuffer',
    dataHandler='Tuple', options=[['port', '61000']],
    schema=[['value', 'DOUBLE']]
})

element_window = ELEMENTWINDOW({size = 16, slide = 16}, input)

fft = AGGREGATE({AGGREGATIONS = [['fft', 'value', 'fft']]}, element_window)

unnest = UNNEST({attribute='fft'}, fft)