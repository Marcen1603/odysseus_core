/// OdysseusScript
#PARSER CQL
#TRANSCFG Standard
#ADDQUERY

///# Geometry RotateViewPoint(Geometry g, double angle);
///# Geometry -> Liste mit Paaren aus cord.x und cord.y
///# RotateViewPoint dreht das Koordinatensystem um "angle".
///# Aendert also alle x,y-Paare aus Geometrie um dies zu erreichen.

///# 1. fest definiertes Geometry-Objekt und angle
GRANT READ ON test:stream TO Public;
ATTACH STREAM test:stream (timestamp STARTTIMESTAMP, points SpatialMultiPoint, angle DOUBLE) FILE 'salsa/data/RotateViewPoint_Geometry.csv'

///# 2. fest definierte Werte als Parameter fuer RotateViewPoint benutzen und diese ausfuehren
///map({expressions = ['RotateViewPoint(scan, 43.0)']}, globalLms1Punctuation)

///#RUNQUERY
///SELECT RotateViewPoint(points, angle) AS scan FROM nexmark:coordinates

///# (3. Die erwartete Ausgabe ist zu finden in der Datei RotateViewPoint.csv)
 
 
#PARSER PQL
#TRANSCFG Standard
#RUNQUERY
RotateViewPoint = MAP({expressions = ['RotateViewPoint(points, angle)']}, test:stream)
TESTSINK{fileName = 'salsa/RotateViewPoint.csv', RotateViewPoint} 